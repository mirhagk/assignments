\newcommand{\code}{\texttt}

\documentclass{beamer}
%\usetheme{default}
%\usetheme{Boadilla}
%\usetheme{Madrid}
\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Copenhagen}
%\usetheme{Warsaw}
%\usetheme{Singapore}
%\usetheme{Malmoe}
%\usecolortheme{albatross}

\usepackage{pseudocode}
\usepackage{listings}

\title[RCImmix]{A Description of the RCImmix Algorithm}
\subtitle[RC]{Reference Counting with better heap allocation}
\author[N. Jervis]{Nathan Jervis}
\institute[McMaster]{
  Department of Computer Science\\
  McMaster University, Hamilton\\
  \texttt{jervisnd@mcmaster.ca}\\
  \texttt{1211159}
}


\begin{document}


%--- the titlepage frame -------------------------%
\begin{frame}[plain]
  \titlepage
\end{frame}

%--- the presentation begins here ----------------%
\begin{frame}{Overview}
	\begin{itemize}
		\item Introduction to automatic memory management
		\item Problems with existing reference counting
		\item Optimizations to reference counting
		\item RCImmix algorithm
	\end{itemize}
\end{frame}

\begin{frame}{Manual Memory Management}
	\textbf{Manual Memory Management}
	\begin{itemize}
		\item Difficult to use
		\item Can cause dangling pointers
		\item Leads to memory leaks
	\end{itemize}
	\emph{Much better if the compiler/runtime can manage memory for us}
\end{frame}

\begin{frame}{Automatic Memory Management}
	\textbf{Tracing Garbage Collector:}
	\begin{itemize}
		\item Periodically pause program and follow program references
		\item Collect anything not referred to
	\end{itemize}
	\textbf{Reference Counting:}
	\begin{itemize}
		\item Counter keeps track of how many things are pointing to it
		\item When counter reaches 0, free memory
		\item \code{Allocate}, \code{Retain}, \code{Release}
	\end{itemize}
\end{frame}

\begin{frame}{Reference Counting vs Tracing}
	\textbf{Tracing Garbage Collector:}
	\begin{itemize}
		\item Little work for allocation
		\item Better cache performance (with compacting)
		\item Requires pausing to collect
	\end{itemize}
	\textbf{Reference Counting:}
	\begin{itemize}
		\item Doesn't pause
		\item Huge overhead
		\item Poor cache locality
	\end{itemize}
\end{frame}

\begin{frame}{RCImmix Optimizations}
	\textbf{Optimizations}
	\begin{itemize}
		\item Tracing collector as a backup
		\item Limited Bit Count
		\item Block Based allocation
		\item Nursery Allocation and Copying Collectors
		\item Objects are born as dead
	\end{itemize}
\end{frame}

\begin{frame}{Tracing Backup Collector}
	\begin{itemize}
		\item Naive reference counting won't collect cycles
		\item Reference counting handle normal memory collection
		\item When cycle garbage accumulates too much, call Tracer
		\item Tracer will very rarely be called, so you still don't have to worry about pauses too much
	\end{itemize}
\end{frame}

\begin{frame}{Limited bit count}
	\begin{itemize}
		\item In theory every object could point to object, requires 32 bits (or 64)
	\end{itemize}
\end{frame}


\begin{frame}{Introducing RCImmix}
	\textbf{RCImmix - reference counting on steroids}
	\begin{itemize}
		\item Builds upon serious of smaller optimizations
		\item Can detect cycles
		\item Can use block-based memory allocation
		\item Much better cache performance
		\item requires only a few bits to store counter (can even use existing space in object header)
	\end{itemize}
\end{frame}

\addtocounter{section}{1}

\begin{frame}[fragile]
\frametitle{RCImmix - How it works}
	\begin{pseudocode}{Allocate}{size}
	pointer.location \GETS \CALL{blockAllocate}{size}\\
	pointer.count \GETS 1\\
	\RETURN{pointer}
	\end{pseudocode}\\
	Make sure each time it's copied call \texttt{Retain} and each time something stops referring to it call \texttt{Release}
\end{frame}

\begin{frame}{RCImmix - How it works}
	\begin{pseudocode}{Retain}{pointer}
	\IF pointer \NOT max
		\THEN pointer.count \GETS pointer.count + 1
	\end{pseudocode}
%	\begin{pseudocode}{Release}{pointer}
		
%	\end{pseduocode}
\end{frame}

\begin{frame}{RCImmix - Cycle Collection}
	\textbf{How RC Immix deals with Cycles}
	\begin{itemize}
		\item Don't worry about cycles
		\item Will lead to unclaimed garbage
		\pause
		\item Backup tracing collector
		\item Will eventually be discovered and collected
	\end{itemize}
\end{frame}

\begin{frame}{RCImmix - Smaller counter}
	\begin{itemize}
		\item In theory: Every possible memory location could point to one spot
		\item In practice: Only a few things will ever point to it
		\item 4 bits will work for most objects
		\item If it reaches \texttt{1111} let it stay there
		\item Again leads to garbage
		\item Tracer will fix counter
	\end{itemize}
\end{frame}

\begin{frame}{RCImmix - Better cache performance}
	
\end{frame}

\end{document}